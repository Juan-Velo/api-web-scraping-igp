service: api-igp-sismos
# org: juanvelo
# app: api-igp-sismos
frameworkVersion: '3'

provider:
  name: aws
  runtime: python3.11
  memorySize: 512 # 512MB es suficiente para scraping simple
  timeout: 30     # Aumentado un poco por si el sitio del IGP demora
  iam:
    role: arn:aws:iam::902206004539:role/LabRole # VERIFICAR: Reemplaza '902206004539' con tu ID de cuenta AWS actual si es diferente
  environment:
    TABLE_NAME: TablaSismosIGP

functions:
  scrape_igp:
    handler: scrap_table.lambda_handler
    events:
      - http:
          path: /sismos/top10
          method: get
          cors: true

resources:
  Resources:
    TablaSismosIGP:
      Type: AWS::DynamoDB::Table
      Properties:
        TableName: TablaSismosIGP
        AttributeDefinitions:
          - AttributeName: id
            AttributeType: S
        KeySchema:
          - AttributeName: id
            KeyType: HASH
        BillingMode: PAY_PER_REQUEST

plugins:
  - serverless-python-requirements

custom:
  pythonRequirements:
    dockerizePip: non-linux # Ayuda a compilar las librer√≠as correctamente